<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js'></script>
<script>
	$(document).ready(function() {
		$("#btnCancelCreate").click(function() {
			toggle(".createPanel", 'hide');
			$("#createrecordCancel").hide();
			$("#createrecord").show('slow');
			return false;
		});
		function toggle(id, toggle) {
			$(id).animate({
				left : '+=50',
				height : toggle
			}, 500, function() {
			});
		}

		var url = "{{ path('building_site_create') }}";
		$("#formCreate").submit(function() {
			$.ajax({
				type : "POST",
				url : 'create',
				data : $(this).serialize(),
				success : function(msg) {
                    var arrMsg = msg.split('_');
                    if (arrMsg.length > 1){
                        var id = arrMsg[1];
                    }
                    var str = msg;
                    if (str.search('error') > -1 && arrMsg.length == 2){
                        alert('ชื่อ "'+id+'" นี้มีข้อมูลอยู่แล้ว \nกรุณาตั้งชื่ออื่น');
                        $("#ftr_adminbundle_building_sitetype_building_name").focus();
                    }else if (str.search('finish') > -1 && arrMsg.length == 2) {
						toggle(".createPanel", 'hide');
						$(".createPanel").html('');
						$("#createrecordCancel").hide();
						$("#createrecord").show('slow');
						$('#listBuildingSite').fadeOut('slow').load(window.location + "show").fadeIn("slow");
                        saveIdBuildingSite = id;
                        var strUrl = "{{ path('facility2site_show', { 'id': '--' }) }}";
                        strUrl = strUrl.replace('--', id);
                        $('.innerPanel').fadeOut().load(strUrl).fadeIn("slow");
                        alert('เพิ่ม BUILDING SITE สำเร็จแล้ว');
					} else {alert(msg);
                        $('.createPanel').fadeOut('slow').load(msg).fadeIn("slow");
						alert('การ CREATE ผิดพลาด\n** กรุณาตรวจสอบ **');
					}
				}
			});
			return false;
		});
	});

    //ตรวจสอบค่าที่เป็น Double
    function validate(evt) {
        var theEvent = evt || window.event;
        var key = theEvent.keyCode || theEvent.which;
        key = String.fromCharCode( key );
        var regex = /[0-9]|\./;
        if( !regex.test(key) ) {
            theEvent.returnValue = false;
            if(theEvent.preventDefault)
                theEvent.preventDefault();
        }
    }
</script>
<style type="text/css">
    #btnCreate {
        background: url("{{ asset('images/add-bt.png')}}") no-repeat;
        display: block;
        float: none;
        height: 50px;
        position: absolute;
        margin-left: 70px;
        margin-top: -55px;
    }

    #btnInputCreate {
        background: url("{{ asset('images/add-bt.png')}}") no-repeat;
        opacity: 0;
        -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
        filter: alpha(opacity=0);
        cursor: pointer;
        height: 50px;
        width: 50px;
    }
</style>
<div id="divPostCreate">
	<form id="formCreate" action="{{ path('building_site_create') }}" method="post" {{ form_enctype(form) }}>
		<fieldset>
			<legend>
				CREATE BUILDING TYPE
			</legend>
			<div class="label" style="">
				{{ form_label(form.building_type_id) }}
			</div>
			{{ form_widget(form.building_type_id, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.building_type_id) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.zone_id) }}
			</div>
			{{ form_widget(form.zone_id, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.zone_id) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.pay_type_id) }}
			</div>
			{{ form_widget(form.pay_type_id, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.pay_type_id) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.user_owner_id) }}
			</div>
			{{ form_widget(form.user_owner_id, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.user_owner_id) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.building_name) }}
			</div>
			{{ form_widget(form.building_name, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.building_name) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.building_address) }}
			</div>
			{{ form_widget(form.building_address, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.building_address) }}
			<br />

			<div class="label" style="">
				{{ form_label(form.phone_number) }}
			</div>
			{{ form_widget(form.phone_number, { 'attr': {'class': 'widthin'} }) }} &nbsp;
			{{ form_errors(form.phone_number) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.latitude) }}
			</div>
			{{ form_widget(form.latitude, { 'attr': {'class': 'widthin', 'onkeypress' : 'validate(event)'} }) }} &nbsp;
			{{ form_errors(form.latitude) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.longitude) }}
			</div>
			{{ form_widget(form.longitude, { 'attr': {'class': 'widthin', 'onkeypress' : 'validate(event)'} }) }} &nbsp;
			{{ form_errors(form.longitude) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.recommend) }}
			</div>
			{{ form_widget(form.recommend) }} &nbsp;
			{{ form_errors(form.recommend) }}
			<br />
			<br />

			<div class="label" style="">
				{{ form_label(form.detail) }}
			</div>
            {{ form_widget(form.detail, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.detail) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.contact_name) }}
			</div>
			{{ form_widget(form.contact_name, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.contact_name) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.contact_email) }}
			</div>
			{{ form_widget(form.contact_email, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.contact_email) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.website) }}
			</div>
			{{ form_widget(form.website, { 'attr': {'class': 'widfat'} }) }} &nbsp;
			{{ form_errors(form.website) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.month_stay) }}
			</div>
			{{ form_widget(form.month_stay, { 'attr': {'class': 'widthin'} }) }} &nbsp;
			{{ form_errors(form.month_stay) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.water_unit) }}
			</div>
			{{ form_widget(form.water_unit, { 'attr': {'class': 'widthin', 'onkeypress' : 'validate(event)'} }) }} &nbsp;
			{{ form_errors(form.water_unit) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.electricity_unit) }}
			</div>
			{{ form_widget(form.electricity_unit, { 'attr': {'class': 'widthin', 'onkeypress' : 'validate(event)'} }) }} &nbsp;
			{{ form_errors(form.electricity_unit) }}
			<br />
			<div class="label" style="">
				{{ form_label(form.internet_price) }}
			</div>
			{{ form_widget(form.internet_price, { 'attr': {'class': 'widthin', 'onkeypress' : 'validate(event)'} }) }} &nbsp;
			{{ form_errors(form.internet_price) }}
			<br />
            <div class="label" style="">
                {{ form_label(form.nearly_place) }}
            </div>
            {{ form_widget(form.nearly_place, { 'attr': {'class': 'widfat'} }) }} &nbsp;
            {{ form_errors(form.nearly_place) }}
            <br />

            {#ต้องแปะไว้ตรงท้ายเสมอ	#}
			{{ form_rest(form) }}
			
			<span style="float: right;">
				<img src="{{ asset('images/cancel.png')}}" id="btnCancelCreate" width="50" height="50" style="cursor:pointer;margin-right: 70px" />
				&nbsp;&nbsp;
                <div id="btnCreate">
                    <input type="submit" id="btnInputCreate" value="CREATE">
                </div>
			</span>
		</fieldset>
	</form>
</div>